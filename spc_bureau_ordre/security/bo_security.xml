<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record model="ir.module.category" id="module_bureau_ordre_parent">
            <field name="name">Bureau d'ordre</field>
        </record>

        <record model="ir.module.category" id="module_bureau_ordre">
            <field name="name">Bureau d'ordre</field>
            <field name="description">Les types d'utilsateurs du bureau d'ordre</field>
            <field name="parent_id" ref="spc_bureau_ordre.module_bureau_ordre_parent"/>
        </record>

        <record id="group_bo_user_service" model="res.groups">
            <field name="name">Agent Service</field>
            <field name="comment">L'utilisateur pourra faire le suivi des courriers entrants/sortants sans avoir l'accès au configuration des données.</field>
            <field name="category_id" ref="spc_bureau_ordre.module_bureau_ordre"/>
        </record>

        <record id="group_bo_manager_service" model="res.groups">
            <field name="name">Responsable Service</field>
            <field name="comment">L'utilisateur pourra faire le suivi des courriers entrants/sortants sans avoir l'accès au configuration des données.</field>
            <field name="category_id" ref="spc_bureau_ordre.module_bureau_ordre"/>
        </record>

        <record id="group_bo_user" model="res.groups">
            <field name="name">Agent B.O</field>
            <field name="comment">L'utilisateur pourra faire le suivi des courriers entrants/sortants sans avoir l'accès au configuration des données.</field>
            <field name="category_id" ref="spc_bureau_ordre.module_bureau_ordre"/>
        </record>

        <record id="group_bo_manager" model="res.groups">
            <field name="name">Responsable B.O</field>
            <field name="comment">L'utilisateur pourra faire le suivi des courriers entrants/sortants avec l'accès au configuration des données.</field>
            <field name="category_id" ref="spc_bureau_ordre.module_bureau_ordre"/>
            <field name="implied_ids" eval="[(4, ref('spc_bureau_ordre.group_bo_user')),(4, ref('spc_bureau_ordre.group_bo_manager_service'))]"/>
        </record>

        <record id="base.default_user" model="res.users">
            <field name="groups_id" eval="[(4,ref('spc_bureau_ordre.group_bo_manager'))]"/>
        </record>

        <record id="bo_manager_service_rule" model="ir.rule">
            <field name="name">Responsable service : Voir les courriers de son service</field>
            <field ref="model_courrier_entrant" name="model_id"/>
            <field name="domain_force">[('department_id.member_ids','in',[dep.id for dep in user.employee_ids]),('state','=','service')]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_manager_service'))]"/>
        </record>

        <record id="bo_agent_service_rule" model="ir.rule">
            <field name="name">Agent service : Voir ses courriers seulement</field>
            <field ref="model_courrier_entrant" name="model_id"/>
            <field name="domain_force">[('department_id.member_ids','in',[dep.id for dep in user.employee_ids]),('state','in',('agent','traiter'))]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_user_service'))]"/>
        </record>

         <record id="bo_manager_rule" model="ir.rule">
            <field name="name">Responsable BO : Voir tout</field>
            <field ref="model_courrier_entrant" name="model_id"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_manager'))]"/>
        </record>
        
        
        <record id="bo_user_rule" model="ir.rule">
            <field name="name">Agent B.O : Voir tout</field>
            <field ref="model_courrier_entrant" name="model_id"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_user'))]"/>
        </record>
        
        
        
        <!-- COURRIER SORTANT -->
        
         <record id="bo_manager_service_sortant_rule" model="ir.rule">
            <field name="name">Responsable service : Voir les courriers de son service</field>
            <field ref="model_courrier_sortant" name="model_id"/>
            <field name="domain_force">[('department_id.member_ids','in',[dep.id for dep in user.employee_ids]),('state','in',('to_service','to_sousdirect','to_soumdirect'))]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_manager_service'))]"/>
        </record>

        <record id="bo_agent_service_sortant_rule" model="ir.rule">
            <field name="name">Agent service : Voir ses courriers seulement</field>
            <field ref="model_courrier_sortant" name="model_id"/>
            <field name="domain_force">[('department_id.member_ids','in',[dep.id for dep in user.employee_ids]),('state','in',('to_service','to_sousdirect'))]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_user_service'))]"/>
        </record>

         <record id="bo_manager_sortant_rule" model="ir.rule">
            <field name="name">Responsable BO : Voir tout</field>
            <field ref="model_courrier_sortant" name="model_id"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_manager'))]"/>
        </record>
        
        
        <record id="bo_user_sortant_rule" model="ir.rule">
            <field name="name">Agent B.O : Voir tout</field>
            <field ref="model_courrier_sortant" name="model_id"/>
            <field name="domain_force">[('department_id.member_ids','in',[dep.id for dep in user.employee_ids]),('state','in',('traiter','draft'))]</field>
            <field name="groups" eval="[(4, ref('spc_bureau_ordre.group_bo_user'))]"/>
        </record>
    </data>
</odoo>
